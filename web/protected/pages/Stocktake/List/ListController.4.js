var PageJs=new Class.create;
PageJs.prototype=Object.extend(new CRUDPageJs,{init:function(){this._bindSubmitButton();return this},_bindSubmitButton:function(){var a,b;a=this;b=$("item-list").up(".panel").down('[type="submit"]');if(!b)return a;b.observe("click",function(){if(b.readAttribute("disabled"))return a;b.writeAttribute("disabled",!0);a._submit(a._collectData())});return a},_submit:function(a){var b,c;b=this;b.postAjax(b.getCallbackId("stocktake"),a,{onSuccess:function(a,e){try{(c=b.getResp(e,!1,!0))&&c.email&&c.asset&&
b.showModalBox("Success",'<b class="success">An email will be send to :'+c.email+'</b>With an attached excel: <a href="'+c.asset.url+'" target="__BLANK">'+c.asset.filename+"</a>")}catch(f){b.showModalBox("Error","<pre>"+f+"</pre>")}},onComplete:function(){}});return b},_collectData:function(){var a,b,c;a=this;b=[];$("item-list-body").getElementsBySelector(".item_row[item_id]").each(function(d){c=a._collectFormData(d,"save-item");c.item=d.retrieve("data");b.push(c)});return b},_getTitleRowData:function(){this._titleRowData.serverMeasurement=
{ServeMeasurement:{name:"Server Measurement"}};this._titleRowData.unitPrice="Unit Price";return this._titleRowData},_getInput:function(a){return(new Element("input",{"save-item":a,type:"number"})).setStyle("width: 100%")},_getResultRow:function(a,b){var c,d;c=b||!1;d=!0===c?"strong":"span";return(new Element("span",{"class":"row"})).store("data",a).addClassName(!1===a.active&&!1===c?"warning":"").addClassName("list-group-item").addClassName("item_row").writeAttribute("item_id",a.id).insert({bottom:(new Element(d,
{"class":"name col-sm-5 col-xs-12",title:a.description})).update(a.name)}).insert({bottom:(new Element(d,{"class":"serverMeasurement col-sm-3 col-xs-12"})).update(a.serverMeasurement.ServeMeasurement.name)}).insert({bottom:(new Element(d,{"class":"stocktakeShop col-sm-2 col-xs-12"})).update(!0===c?"Stocktake QTY (Shop)":this._getInput("stocktakeShop"))}).insert({bottom:(new Element(d,{"class":"stocktakeStoreRoom col-sm-2 col-xs-12"})).update(!0===c?"Stocktake QTY (Store Room)":this._getInput("stocktakeStoreRoom"))})}});